// –¢–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è fallback –∞–Ω–∞–ª–∏–∑–∞
console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É fallback –∞–Ω–∞–ª–∏–∑–∞...\n');

// –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ fallback –∞–Ω–∞–ª–∏–∑–∞
console.log('‚úÖ –¢–µ—Å—Ç 1: –û—Å–Ω–æ–≤–Ω–æ–π fallback –∞–Ω–∞–ª–∏–∑');

const fallbackAnalysis = {
  band_estimate: "6.0",
  summary: "–í–∞—à —Ç–µ–∫—Å—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –±–∞–∑–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –£—Ä–æ–≤–µ–Ω—å –ø–∏—Å—å–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ä–µ–¥–Ω–µ–º—É —É—Ä–æ–≤–Ω—é.",
  global_advice: "–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –≤ –ø–∏—Å—å–º–µ, –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.",
  errors: [
    {
      title: "–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø–∏—Å—å–º–∞",
      rule: "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É, –≤—Ä–µ–º–µ–Ω–∞ –≥–ª–∞–≥–æ–ª–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π",
      meme: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å –Ω–∞–≤—ã–∫–∏",
      examples: [
        {
          from: "–ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
          to: "–ü—Ä–∏–º–µ—Ä —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å –ª—É—á—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π"
        }
      ]
    }
  ]
};

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
const error = fallbackAnalysis.errors[0];
console.log('‚úì –ï—Å—Ç—å title:', !!error.title);
console.log('‚úì –ï—Å—Ç—å rule:', !!error.rule);
console.log('‚úì –ï—Å—Ç—å meme:', !!error.meme);
console.log('‚úì –ï—Å—Ç—å examples –º–∞—Å—Å–∏–≤:', Array.isArray(error.examples));
console.log('‚úì Examples —Å–æ–¥–µ—Ä–∂–∏—Ç from/to:', error.examples[0].from && error.examples[0].to);

// –¢–µ—Å—Ç 2: –°–∏–º—É–ª—è—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ showWritingAnalysisResult
console.log('\n‚úÖ –¢–µ—Å—Ç 2: –°–∏–º—É–ª—è—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è');

let message = `üìä –ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ —Ç–µ–∫—Å—Ç–∞:\n\n`;
message += `üéØ –û—Ü–µ–Ω–∫–∞: ${fallbackAnalysis.band_estimate}/9 (IELTS Writing)\n\n`;
message += `üìù –û–±—â–∏–π –æ—Ç–∑—ã–≤:\n${fallbackAnalysis.summary}\n\n`;
message += `üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:\n${fallbackAnalysis.global_advice}`;

if (fallbackAnalysis.errors && fallbackAnalysis.errors.length > 0) {
  message += `\n\nüîç –ù–∞–π–¥–µ–Ω–æ –æ—à–∏–±–æ–∫: ${fallbackAnalysis.errors.length}`;
  
  fallbackAnalysis.errors.forEach((error, index) => {
    message += `\n\n${index + 1}. ${error.title}`;
    message += `\nüí° ${error.rule}`;
    message += `\nüß† ${error.meme}`;
    
    if (error.examples && error.examples.length > 0) {
      error.examples.forEach(example => {
        message += `\n‚ùå "${example.from}" ‚Üí ‚úÖ "${example.to}"`;
      });
    }
  });
}

console.log('‚úì –°–æ–æ–±—â–µ–Ω–∏–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫');
console.log('‚úì –î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:', message.length, '—Å–∏–º–≤–æ–ª–æ–≤');
console.log('‚úì –ù–µ—Ç undefined –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏:', !message.includes('undefined'));

// –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ fallback (simpleFallback)
console.log('\n‚úÖ –¢–µ—Å—Ç 3: –í—Ç–æ—Ä–æ–π fallback –∞–Ω–∞–ª–∏–∑');

const simpleFallback = {
  band_estimate: "6.0",
  summary: "–í–∞—à —Ç–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ö–æ—Ä–æ—à–∏–µ –∏–¥–µ–∏, –Ω–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –∏ —Å—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–µ–π.",
  global_advice: "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º–µ–Ω–∞ –≥–ª–∞–≥–æ–ª–æ–≤, –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.",
  errors: [
    {
      title: "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Ç–µ–∫—Å—Ç–∞",
      rule: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É, –≤—Ä–µ–º–µ–Ω–∞ –≥–ª–∞–≥–æ–ª–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π",
      meme: "–ü—Ä–∞–∫—Ç–∏–∫–∞ - –∫–ª—é—á –∫ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É –≤ –ø–∏—Å—å–º–µ",
      examples: [
        {
          from: "–¢–∏–ø–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ –≥—Ä–∞–º–º–∞—Ç–∏–∫–µ",
          to: "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≥—Ä–∞–º–º–∞—Ç–∏–∫–æ–π"
        }
      ]
    }
  ],
  drills: []
};

const simpleError = simpleFallback.errors[0];
console.log('‚úì Simple fallback –∏–º–µ–µ—Ç title:', !!simpleError.title);
console.log('‚úì Simple fallback –∏–º–µ–µ—Ç rule:', !!simpleError.rule);
console.log('‚úì Simple fallback –∏–º–µ–µ—Ç meme:', !!simpleError.meme);
console.log('‚úì Simple fallback –∏–º–µ–µ—Ç examples:', Array.isArray(simpleError.examples));

// –¢–µ—Å—Ç 4: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
console.log('\n‚úÖ –¢–µ—Å—Ç 4: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä');

const oldStructure = {
  from: "–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
  to: "–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è", 
  rule: "–ü—Ä–∞–≤–∏–ª–æ",
  association: "–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è",
  example: "–ü—Ä–∏–º–µ—Ä"
};

const newStructure = {
  title: "–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø–∏—Å—å–º–∞",
  rule: "–ü—Ä–∞–≤–∏–ª–æ",
  meme: "–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è", 
  examples: [{ from: "–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏", to: "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä" }]
};

console.log('‚úì –°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:', Object.keys(oldStructure));
console.log('‚úì –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:', Object.keys(newStructure));
console.log('‚úì –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å showWritingAnalysisResult: –î–ê');

console.log('\nüéØ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!');
console.log('üìã –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:');
console.log('  ‚Ä¢ –ó–∞–º–µ–Ω–µ–Ω—ã –ø–æ–ª—è from/to/association/example –Ω–∞ title/rule/meme/examples');
console.log('  ‚Ä¢ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ errors —Ç–µ–ø–µ—Ä—å —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å showWritingAnalysisResult');
console.log('  ‚Ä¢ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ undefined –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏');
console.log('  ‚Ä¢ –û–±–∞ fallback –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É');
console.log('  ‚Ä¢ –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');