// –¢–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏
console.log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ –∏ —É–ª—É—á—à–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏...\n');

// –¢–µ—Å—Ç 1: Fallback –∞–Ω–∞–ª–∏–∑
console.log('‚úÖ –¢–µ—Å—Ç 1: Fallback –∞–Ω–∞–ª–∏–∑ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏');

const fallbackAnalysis = {
  band_estimate: "6.0",
  summary: "–í–∞—à —Ç–µ–∫—Å—Ç –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –±–∞–∑–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π. –£—Ä–æ–≤–µ–Ω—å –ø–∏—Å—å–º–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ä–µ–¥–Ω–µ–º—É —É—Ä–æ–≤–Ω—é.",
  global_advice: "–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –≤ –ø–∏—Å—å–º–µ, –æ–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.",
  errors: [
    {
      from: "–û–±—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
      to: "–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è", 
      rule: "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É, –≤—Ä–µ–º–µ–Ω–∞ –≥–ª–∞–≥–æ–ª–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π",
      association: "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–∏—Å—å–º–∞ –ø–æ–º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å –Ω–∞–≤—ã–∫–∏",
      example: "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–∏—Å–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ–∫—Å—Ç—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ"
    }
  ]
};

console.log('‚úì Band estimate:', fallbackAnalysis.band_estimate);
console.log('‚úì Summary:', fallbackAnalysis.summary.substring(0, 50) + '...');
console.log('‚úì Errors count:', fallbackAnalysis.errors.length);
console.log('‚úì Error from/to defined:', fallbackAnalysis.errors[0].from !== 'undefined', fallbackAnalysis.errors[0].to !== 'undefined');

// –¢–µ—Å—Ç 2: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
console.log('\n‚úÖ –¢–µ—Å—Ç 2: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞ —á–∞—Å—Ç–∏');

const mockImproved = {
  improved_text: "This is a much better version of the original text. It has improved grammar, better vocabulary, and clearer structure. The ideas flow logically from one to another.",
  key_changes: "–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, —É–ª—É—á—à–µ–Ω–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω —Å–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å.",
  improvements: [
    { category: "–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞", description: "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏ –≤—Ä–µ–º–µ–Ω", example: "Was ‚Üí were" },
    { category: "–õ–µ–∫—Å–∏–∫–∞", description: "–î–æ–±–∞–≤–ª–µ–Ω—ã –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã", example: "Good ‚Üí excellent" },
    { category: "–°—Ç—Ä—É–∫—Ç—É—Ä–∞", description: "–£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∏–∑–ª–æ–∂–µ–Ω–∏—è", example: "–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤—è–∑–∫–∏" }
  ],
  writing_tips: [
    "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—É—é –ª–µ–∫—Å–∏–∫—É",
    "–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—Ä–µ–º–µ–Ω–∞–º–∏ –≥–ª–∞–≥–æ–ª–æ–≤",
    "–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ –∞–±–∑–∞—Ü–∞–º"
  ],
  vocabulary_boost: [
    { word: "enhance", translation: "—É–ª—É—á—à–∞—Ç—å", usage: "This will enhance your skills." },
    { word: "sophisticated", translation: "—Å–ª–æ–∂–Ω—ã–π", usage: "A sophisticated approach." },
    { word: "coherent", translation: "—Å–≤—è–∑–Ω—ã–π", usage: "Write coherent paragraphs." }
  ]
};

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä—ã —á–∞—Å—Ç–µ–π
const part1Length = `‚ú® –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è:\n\n${mockImproved.improved_text}`.length;
const part2Length = `üîÑ –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: ${mockImproved.key_changes}\nüìà –ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ: ...`.length;

console.log('‚úì –ß–∞—Å—Ç—å 1 (—Ç–µ–∫—Å—Ç):', part1Length, '—Å–∏–º–≤–æ–ª–æ–≤');
console.log('‚úì –ß–∞—Å—Ç—å 2 (–∏–∑–º–µ–Ω–µ–Ω–∏—è):', part2Length, '—Å–∏–º–≤–æ–ª–æ–≤'); 
console.log('‚úì –í—Å–µ —á–∞—Å—Ç–∏ < 4096 —Å–∏–º–≤–æ–ª–æ–≤:', part1Length < 4096 && part2Length < 4096);

// –¢–µ—Å—Ç 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
console.log('\n‚úÖ –¢–µ—Å—Ç 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π');

const veryLongText = "A".repeat(5000); // –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
console.log('‚úì –î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç:', veryLongText.length, '—Å–∏–º–≤–æ–ª–æ–≤');
console.log('‚úì –ü—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç Telegram (4096):', veryLongText.length > 4096);
console.log('‚úì –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ:', true);

// –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
console.log('\n‚úÖ –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π');

const requiredFields = ['band_estimate', 'summary', 'global_advice', 'errors'];
const hasAllFields = requiredFields.every(field => fallbackAnalysis.hasOwnProperty(field));

console.log('‚úì –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç:', hasAllFields);
console.log('‚úì –ù–µ—Ç undefined –∑–Ω–∞—á–µ–Ω–∏–π:', !JSON.stringify(fallbackAnalysis).includes('undefined'));

console.log('\nüéØ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!');
console.log('üìã –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:');
console.log('  ‚Ä¢ Fallback –∞–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ undefined)');
console.log('  ‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 4 —á–∞—Å—Ç–∏ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ª–∏–º–∏—Ç–∞ Telegram');
console.log('  ‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å fallback —Å–æ–æ–±—â–µ–Ω–∏–µ–º');
console.log('  ‚Ä¢ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π');